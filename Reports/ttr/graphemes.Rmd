---
title: "Grapheme TTR in 100LC"
author: "Steven Moran"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  github_document:
  pandoc_args: --webtex
---

```{r echo=FALSE, include=FALSE}
library(dplyr)
library(knitr)
library(stringr)
```

Load each grapheme orthography profile (OP) from disk, generate TTRs, and write to a table.

```{r}
# Create results data frame
header <- c("name", "types", "tokens", "ttr")
results <- as.data.frame(matrix(,0,length(header)))
names(results) <- header

# Loop over the OPs
fils <- list.files("../graphemes/orthography_profiles", pattern="csv$", full.names = TRUE, recursive = TRUE)

# Test:
# file <- fils[1]

for (file in fils) {
  # Get language name from file path
  s <- unlist(strsplit(file, "/"))
  filename <- tail(s, n=1)
  filename <- str_remove(filename, ".csv")
  
  # Read the OP
  df <- read.csv(file=file)

  # Get ttr
  tokens <- sum(df$Frequency)
  types <- length(unique(df$Grapheme))
  ttr <- (types / tokens)
  
  # Add to results data frame
  result <- c(filename, types, tokens, ttr)
  # results <- rbind(results, result)
  results[nrow(results) + 1,] <- result
}

# Clean up
results$types <- as.integer(results$types)
results$tokens <- as.integer(results$tokens)
results$ttr <- as.numeric(results$ttr)
```

```{r}
results %>% kable()
```

Write the results to CSV.

```{r}
write.csv(results, file="graphemes_ttr.csv", row.names=FALSE)
```

Plot the TTR for graphemes.

```{r}
library(ggplot2)
p <- results
p$name <- factor(p$name, levels = p$name[order(p$ttr)])
qplot(name, ttr, data=p) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

