# language_name_wals:	Russian
# language_name_glotto:	Russian
# ISO_6393:	rus
# year_composed:	NA
# year_published:	NA
# mode:	written
# genre_broad:	technical
# genre_narrow:	NA
# writing_system:	Cyrl
# special_characters:	NA
# short_description:	OpenOffice
# source:	https://object.pouta.csc.fi/OPUS-OpenOffice/v3/raw/ru.zip
# copyright_short:	http://opus.nlpl.eu/OpenOffice.php
# copyright_long:	http://opus.nlpl.eu/OpenOffice.php J. Tiedemann, 2012, Parallel Data, Tools and Interfaces in OPUS. In Proceedings of the 8th International Conference on Language Resources and Evaluation (LREC 2012)
# sample_type:	whole
# comments:	NA

Функции массива
/text/scalc/01/04060107.xhp
матрицы; функции
мастер функций; массивы
формулы для массивов
линейные константы-массивы
формулы;массивы
функции; функции для массивов
редактирование; формулы массивов
копирование; формулы массивов
изменение диапазонов массивов
расчет;условные расчеты
матрицы; расчеты
условные расчеты с массивами
неявная обработка массива
обязательная обработка массива
mw deleted &quot; creating; &quot;
Функции массива
В эту категорию входят функции массива.
Что такое массив?
Массив - связанный диапазон ячеек на листе, содержащих какие-либо значения.
Диапазон, состоящий из 3 строк и 3 столбцов, представляет собой матрицу 3 x 3.
А
B
C
1
7
31
33
2
95
17
2
3
5
10
50
Наименьший массив - 1 x 2 или 2 x 1 (массив из двух смежных ячеек).
Что такое формула массива?
Формула, которая служит для оценки отдельных значений в диапазоне ячеек, называется формулой массива.
Различие между формулой массива и другими типами формул заключается в том, что формула массива одновременно обрабатывает несколько значений.
Формула массива может не только обрабатывать, но и возвращать несколько значений.
Результаты формулы массива также организованы в массив.
=10*A1:C3
и подтвердите ввод с помощью комбинации клавиш
Command
Ctrl
+Shift+Enter.
В результате все значения ячеек в массиве 3 x 3 (A1:C3) будут умножены на 10.
Кроме умножения, к диапазону ссылки (массиву) можно применять и другие операторы.
В $[officename] Calc можно использовать сложение (+), вычитание (-), умножение (*), деление (/), возведение в степень (^), конкатенацию ( & ) и сравнение (=, < > , < , > , < =, > =).
Эти операторы можно применять к отдельным значениям диапазона в виде формулы массива для получения массива результатов.
=A1:A2 = &quot; &quot; }
и
=A1:A2=0}
возвращают массив шириной в 1 столбец и высотой в 2 ряда, состоящий из ячеек со значением TRUE.
Когда следует использовать формулы массива?
внесите в формулу массива необходимые изменения
.
Формулы массивов также позволяют экономить пространство, если требуется рассчитать несколько значений, поскольку эти формулы не отличаются высокими требованиями к памяти.
Кроме того, массивы представляют собой ценный инструмент для сложных расчетов, поскольку в вычисления можно включить несколько диапазонов ячеек.
В $[officename] имеются разнообразные математические функции для массивов, например функция MMULT для умножения двух массивов или функция SUMPRODUCT для вычисления скалярных произведений двух массивов.
Использование формул массива в $[officename] Calc
Можно также создать обычную формулу, в которой диапазоны ссылки, например параметры, указывают на формулу массива.
Результат рассчитывается для пересечения массива ссылки и строк или столбцов, содержащих формулу.
Если пересечение отсутствует или массив на пересечении включает несколько строк или столбцов, отображается сообщение об ошибке &quot; #ЗНАЧ! &quot; .
Такое использование формул демонстрируется в следующем примере.
Создание формул массива
мастера функций
следует каждый раз устанавливать флажок
Массив
, чтобы результаты возвращались в виде массива.
В противном случае будет возвращаться только значение в верхней левой ячейке массива.
Command
Ctrl
+Enter.
Только после этого формула станет формулой массива.
В $[officename] Calc формулы массива заключаются в фигурные скобки.
Введение фигурных скобок вручную невозможно.
Ячейки в массиве результатов автоматически становятся недоступными для изменений.
Однако формулу массива можно редактировать или копировать путем выделения всего массива.
Использование строчных констант-массивов в формулах
Calc поддерживает в формулах строчные матрицы/массивы констант.
Строчный массив заключается в фигурные скобки ''{ &quot; и &quot; } &quot; .
Элементы могут быть как числовыми (в т.ч. отрицательными), так и логическими (TRUE, FALSE) или строковыми литералами.
Выражения, не являющиеся константами, не допускаются.
Возможен ввод массивов с одной или несколькими строками, а также с одним или несколькими столбцами.
Все строки должны состоять из одинакового числа элементов; все столбцы также должны состоять из одинакового числа элементов.
Разделители столбцов и строк массива зависят от используемого языка и региональных установок.
В настоящей справке указано, что для разделения столбцов и строк массива используются символы «;» и «|» сответственно.
Например, для английского языка символ запятая («,») используется как разделитель столбцов массива, а символ точка с запятой («;») - как разделитель строк.
Вложенность массивов не допускается.
Примеры:
={1;2;3}
Массив с одной строкой, состоящей из трех чисел:
1, 2 и 3.
={1;2;3}
с фигурными скобками и точками с запятой, а затем нажать
Command
Ctrl
+Shift+Enter.
={1;2;3|4;5;6}
Массив с двумя строками и тремя значениями в каждой строке.
={0;1;2|FALSE;TRUE; &quot; two &quot; }
Массив смешанных данных.
=SIN({1;2;3})
Вводится как матричная формула, возвращает три результата функции SIN с аргументами 1, 2 и 3.
Редактирование формул массива
Command
Ctrl
+ /, где / означает клавишу деления на цифровой клавиатуре.
Нажмите клавишу F2 или поместите курсор в строку ввода.
В результате формула станет доступной для редактирования.
Command
Ctrl
+Shift+Enter.
Отдельные части массива доступны для форматирования.
Например, можно изменить цвет шрифта.
Выделите диапазон ячеек и измените нужный атрибут.
Копирование формул массива
Выделите диапазон ячеек или массив, содержащий формулу массива.
Нажмите клавишу F2 или поместите курсор в строку ввода.
Command
Ctrl
+C.
Выделите диапазон ячеек, в который требуется вставить формулу массива, и нажмите клавишу F2 или поместите курсор в строку ввода.
Command
Ctrl
+V в выбранном месте, и подтвердите вставку, нажав
Command
Ctrl
+Shift+Enter.
Выбранный диапазон теперь содержит формулу массива.
Изменение массива
Для редактирования конечного массива следует выполнить следующие действия.
Выделите диапазон ячеек или массив, содержащий формулу массива.
В правом нижнем углу выделенной области появится небольшой значок, с помощью которого диапазон можно увеличить или уменьшить.
При изменении массива формула не изменяется.
Изменяется только диапазон, в котором будут отображаться результаты.
Command
Ctrl
.
Условные расчеты массива
Условные расчеты массива - формула массива или матрицы, которая содержит функцию IF() или CHOOSE().
Аргумент условия в формуле представляет собой ссылку на область или результат в виде матрицы.
В приведенном ниже примере проверка > 0 в формуле {=IF(A1:A3 > 0; &quot; да &quot; ; &quot; нет &quot; )} применяется к каждой ячейке в диапазоне A1:A3, а результат копируется в соответствующую ячейку.
A
B (формула)
B (результат)
1
1
{=IF(A1:A3 > 0; &quot; да &quot; ; &quot; нет &quot; )}
да
2
0
{=IF(A1:A3 > 0; &quot; да &quot; ; &quot; нет &quot; )}
нет
3
1
{=IF(A1:A3 > 0; &quot; да &quot; ; &quot; нет &quot; )}
да
Следующие функции обеспечивают обязательную обработку массива:
CORREL, COVAR, FORECAST, FTEST, INTERCEPT, MDETERM, MINVERSE, MMULT, MODE, PEARSON, PROB, RSQ, SLOPE, STEYX, SUMPRODUCT, SUMX2MY2, SUMX2PY2, SUMXMY2, TTEST.
Если при вызове этих функций в качестве аргументов используются ссылки на область, функции считаются функциями массива.
В следующей таблице приводится пример обязательной обработки массива.
A
B (формула)
B (результат)
C (обязательная формула массива)
C (результат)
1
1
=A1:A2+1
2
=SUMPRODUCT(A1:A2+1)
5
2
2
=A1:A2+1
3
=SUMPRODUCT(A1:A2+1)
5
3
=A1:A2+1
#ЗНАЧ
=SUMPRODUCT(A1:A2+1)
5
функция MUNIT
MUNIT
Вычисляет единичную матрицу заданного размера.
Единичная матрица - квадратный массив, в котором элементы по главной диагонали равны 1, а все остальные элементы равны 0.
Синтаксис:
MUNIT(Размерности)
Размерности
: размер единичной матрицы.
Общие сведения о функциях массива см. в верхней части страницы.
Пример:
Выделите на листе квадратный диапазон, например A1:E5.
Массив
.
Введите размерность для единичной матрицы (в данном случае
5
) и нажмите кнопку
OK
.
=Munit(5)
в последнюю ячейку выбранного диапазона (E5) и нажать комбинацию клавиш
Shift+Command+Enter
Shift+Ctrl+Enter
.
В результате диапазон A1:E5 становится единичной матрицей.
функция FREQUENCY
FREQUENCY
Возвращает частотное распределение в виде массива из одного столбца.
Функция служит для подсчета количества значений в массиве данных, которые находятся в значениях, заданных массивом &quot; Классы &quot; .
Синтаксис:
FREQUENCY(Данные; Классы)
Данные
: ссылка на значения для подсчета.
Классы
: массив предельных значений.
Общие сведения о функциях массива см. в верхней части страницы.
Пример:
В приведенной ниже таблице в столбце A содержится список несортированных измеренных значений.
В столбце B содержится верхний предел для классов, на которые требуется разделить данные из столбца A.
В соответствии с пределом в ячейке B1 функция FREQUENCY возвращает количество значений, которые меньше либо равны 5.
Предел в ячейке B2 равен 10, поэтому функция FREQUENCY возвращает количество значений, которые больше 5 или больше либо равны 10.
Текст в ячейке B6 - &quot; > 25 &quot; - используется в качестве примера.
UFI: replace table by picture
A
B
C
1
12
5
1
2
8
10
3
3
24
15
2
4
11
20
3
5
5
25
1
6
20
> 25
1
7
16
8
9
9
7
10
16
11
33
мастера функций
.
Выделите диапазон
данных
в массиве (A1:A11), а затем диапазон
классов
, в массиве (B1:B6).
Установите флажок
Массив
и нажмите кнопку
ОК
.
Частота отображается в диапазоне C1:C6.
функция MDETERM
детерминанты
MDETERM
Возвращает определитель матрицы.
Эта функция возвращает значение в текущую ячейку.
Для получения результатов необязательно выделять диапазон.
Синтаксис:
MDETERM(Массив)
Массив
: квадратный массив для получения определителей.
Общие сведения об использовании функций массива см. в верхней части страницы.
функция MINVERSE
обратные матрицы
MINVERSE
Возвращает обратную матрицу.
Синтаксис:
MINVERSE(Массив)
Массив
: квадратный массив для получения обратной матрицы.
Пример:
Массив
и нажмите клавишу
ОК
.
функция MMULT
MMULT
Служит для расчета произведения двух массивов.
Количество столбцов в массиве 1 должно совпадать с количеством строк в массиве 2.
В квадратном массиве количество строк и столбцов совпадает.
Синтаксис:
MMULT(Массив; Массив)
Массив
(первый).
Первый массив для расчета произведения.
Массив
(второй).
Второй массив с тем же количеством строк.
Пример:
массив
, затем - второй
массив
.
В
мастере функций
установите флажок
Массив
.
Нажмите кнопку
OK
.
Конечный массив будет отображен в первом выделенном диапазоне.
функция TRANSPOSE
TRANSPOSE
Служит для транспонирования строк и столбцов массива.
Синтаксис:
TRANSPOSE(Массив)
Массив
: массив для транспонирования.
Пример:
Shift+Command+Enter
Shift+Ctrl+Enter
.
Или, если используется
Мастер функций
, установите флажок
Массив
.
Транспонированный массив появится в выбранном целевом диапазоне и будет автоматически защищен от внесения изменений.
функция LINEST
LINEST
Возвращает таблицу статистических данных для прямой линии, которая больше всего соответствует набору данных.
Синтаксис:
LINEST(данные_Y; данные_X; Тип линии; статистика)
данные_Y
- это диапазон из одной строки или столбца, указывающий координаты y в виде набора точек данных.
данные_X
- это соответствующий диапазон из одной строки или столбца, указывающий координаты x.
Если
данные_X
не указаны, по умолчанию используется
1, 2, 3, ..., n
.
Если имеется более одного набора переменных,
данные_X
могут быть диапазоном с соответствующим количеством строк или столбцов.
y = a + bx
, используя линейную регрессию (метод &quot; наименьших квадратов &quot; ).
Если имеется более одного набора переменных, прямая линия имеет форму
y = a + b1x1 + b2x2 ... + bnxn
.
Тип линии
выставлен на FALSE, найденная прямая линия обязана проходить через источник (константа &quot; a &quot; равна нулю; y = bx).
Если значение не указано,
Тип линии
по умолчанию выставляется на TRUE (линия не обязана проходить через источник).
статистика
не указано или выставлено на FALSE, возвращается только верхняя линия таблицы статистических данных.
Если выставлено значение TRUE, возвращается вся таблица.
Command
Ctrl
+Shift+Return вместо одной клавиши Return).
Пример:
данные_Y
.
При необходимости можно ввести и другие параметры.
Установите флажок
Массив
и нажмите кнопку
ОК
.
статистика
указано значение 0).
Если значение параметра
статистика
не равно нулю, будут отображены и другие результаты.
Другие результаты функции LINEST
Просмотрите приведенные ниже примеры.
A
B
C
D
E
F
G
1
x1
x2
y
LIN
EST
2
4
7
100
4,17
3,48
82,33
3
5
9
105
5,46
10,96
9,35
4
6
11
104
0,87
5,06
#NA
5
7
12
108
13,21
4
#NA
6
8
15
111
675,45
102,26
#NA
7
9
17
120
8
10
19
133
мастер функций
.
Чтобы функция LINEST выполнялась правильно, следует установить флажок
Массив
в
мастере функций
.
Затем необходимо выделить в таблице (или ввести вручную) следующие значения:
Данные_Y
- C2:C8
Данные_X
- A2:B8
Тип линии
и
статистика
имеют значение 1.
ОК
$[officename] Calc заполняет выделенный диапазон результатами функции LINEST, как показано в примере.
Формула
соответствует каждой ячейке матрицы функции LINEST
{=LINEST(C2:C8;A2:B8;1;1)} )}
.
Ниже представлены результаты функции LINEST.
наклоны, также см. линии регрессии
линии регрессии;функция LINEST
mw made &quot; regression lines &quot; a two level entry
E2 и F2: наклон линии регрессии y=b+m*x для значений x1 и x2.
Значения даются в обратном порядке; т. е. наклон для x2 в ячейке E2 и наклон для x1 в ячейке F2.
G2.
Пересечение линии b с осью Y.
стандартные ошибки; функции массивов
MW changed &quot; standard errors &quot;
E3 и F3.
Стандартная ошибка для значения наклона.
G3.
Стандартная ошибка для пересечения.
расчеты RSQ
E4:
RSQ
F4.
Стандартная ошибка регрессии, рассчитанной для значения Y.
E5.
Значение F, полученное с помощью дисперсионного анализа.
F5.
Степени свободы, полученные с помощью дисперсионного анализа.
E6.
Сумма квадратов отклонений для примерных значений Y от линейного среднего.
F6.
Сумма квадратов отклонений для примерных значений Y от заданных значений Y.
функция LOGEST
LOGEST
Эта функция служит для расчета корректировки для введенных данных в виде кривой экспоненциальной регрессии (y=b*m^x).
Синтаксис:
LOGEST(ДанныеY; ДанныеX; Тип функции; Статистика)
ДанныеY
- массив данных Y.
ДанныеX
(необязательно) - массив данных X.
Тип функции
(необязательно).
Если тип функции = 0, будут вычислены функции в форме y = m^x.
В противном случае будут вычислены функции y = b*m^x.
Статистика
(необязательно): если этот параметр равен 0, рассчитывается только коэффициент регрессии.
Пример:
См. функцию LINEST.
Однако в данном случае сумма квадратов не рассчитывается.
функция SUMPRODUCT
скалярное произведение
скалярное произведение
скалярное произведение
SUMPRODUCT
Служит для умножения соответствующих элементов в заданных массивах; возвращает сумму произведений.
Синтаксис:
SUMPRODUCT(Массив1; Массив2...
Массив30)
Массив1, Массив2 ...
Массив30
- массивы, элементы которых требуется умножить.
В список аргументов должен входить хотя бы один массив.
Если указан только один массив, суммируются все его элементы.
Пример:
A
B
C
D
1
2
3
4
5
2
6
7
8
9
3
10
11
12
13
=SUMPRODUCT(A1:B3;C1:D3)
возвращает 397.
Вычисление:
A1*C1 + B1*D1 + A2*C2 + B2*D2 + A3*C3 + B3*D3
Функцию SUMPRODUCT можно использовать для расчета скалярного произведения двух векторов.
Функция SUMPRODUCT возвращает отдельное число; ее необязательно вводить в качестве функции массива.
функция SUMX2MY2
SUMX2MY2
Возвращает сумму разниц квадратов соответствующих значений в двух массивах.
Синтаксис:
SUMX2MY2(Массив X; Массив Y)
МассивX
- первый массив, элементы которого необходимо возвести в квадрат и сложить.
Массив Y
- второй массив, элементы которого необходимо возвести в квадрат и вычесть.
функция SUMX2PY2
SUMX2PY2
Возвращает сумму сумм квадратов соответствующих значений в двух массивах.
Синтаксис:
SUMX2PY2(МассивX; МассивY)
МассивX
- первый массив, аргументы которого необходимо возвести в квадрат и сложить.
Массив Y
: второй массив, элементы которого необходимо возвести в квадрат и суммировать.
функция SUMXMY2
SUMXMY2
Служит для сложения квадратов разниц между соответствующими значениями в двух массивах.
Синтаксис:
SUMXMY2(МассивX; МассивY)
МассивX
- первый массив, элементы которого необходимо вычесть и возвести в квадрат.
МассивY
- второй массив, элементы которого необходимо вычесть и возвести в квадрат.
функция TREND
TREND
Возвращает значения по линейному тренду.
Синтаксис:
TREND(ДанныеY; ДанныеX; Новые данныеX; Тип линии)
ДанныеY
- массив данных Y.
ДанныеX
(необязательно) - массив данных X.
Новые данныеX
(необязательно) - массив данных X, которые используются для повторного расчета значений.
Тип линии
(необязательно).
Если тип линии = 0, линии считаются проходящими через начало координат.
В противном случае линии смещаются.
Тип линии по умолчанию < > 0.
Пример:
Массив
и нажмите кнопку
ОК
.
Будут отображены данные тренда для исходящих данных.
функция GROWTH
экспоненциальные тренды в массивах
GROWTH
Служит для расчета точек экспоненциального тренда в массиве.
Синтаксис:
GROWTH(ДанныеY; ДанныеX; Новые данныеX; Тип функции)
ДанныеY
- массив данных Y.
ДанныеX
(необязательно) - массив данных X.
Новые данныеX
(необязательно) - массив данных X, в котором выполняется повторный расчет значений.
Тип функции
(необязательно).
Если тип функции = 0, будут вычислены функции в форме y = m^x.
В противном случае будут вычислены функции y = b*m^x.
Пример:
Массив
и нажмите кнопку
ОК
.