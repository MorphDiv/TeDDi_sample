# language_name_wals:	Russian
# language_name_glotto:	Russian
# ISO_6393:	rus
# year_composed:	NA
# year_published:	NA
# mode:	written
# genre_broad:	technical
# genre_narrow:	NA
# writing_system:	Cyrl
# special_characters:	NA
# short_description:	OpenOffice
# source:	https://object.pouta.csc.fi/OPUS-OpenOffice/v3/raw/ru.zip
# copyright_short:	http://opus.nlpl.eu/OpenOffice.php
# copyright_long:	http://opus.nlpl.eu/OpenOffice.php J. Tiedemann, 2012, Parallel Data, Tools and Interfaces in OPUS. In Proceedings of the 8th International Conference on Language Resources and Evaluation (LREC 2012)
# sample_type:	whole
# comments:	NA

Функция Format [время выполнения]
/text/sbasic/shared/03120301.xhp
Sun Microsystems, Inc.
converted from old format - fpe
функция Format
Функция Format [время выполнения]
Преобразует число в строку и затем форматирует ее согласно указанному формату.
Синтаксис:
Format (Число [, Формат As String])
Возвращаемое значение:
String
Параметры:
Число
.
Число, которое должно быть преобразовано в форматированную строку.
Формат
.
Строка, указывающая код формата для данного числа.
Если параметр
Формат
опущен, функция Format работает как функция
Str
.
Коды форматирования
Ниже перечислены коды, которые можно использовать для форматирования числа.
0:
.
Если параметр
Число
имеет цифру в позиции 0 в коде формата, отображается эта цифра; иначе отображается ноль.
Число
имеет меньше цифр, чем количество нулей в коде формата (по любую сторону от десятичного разделителя), недостающие разряды заполняются нулями.
Если число имеет больше цифр слева от десятичного разделителя, чем количество нулей в коде формата, эти дополнительные цифры отображаются без форматирования.
Формат
после десятичного разделителя.
#:
.
Если параметр
Число
содержит цифру в позиции местозаполнителя # в коде
Формат
, отображается эта цифра; в любом другом случае в этой позиции ничего не отображается.
Этот символ работает как 0, за исключением того, что заполняющие нули (слева или справа) не отображаются, когда в коде формата имеется больше символов #, чем цифр в этом числе.
Отображаются только необходимые цифры в этом числе.
.
.
Десятичный местозаполнитель определяет количество десятичных разрядов слева и справа от десятичного разделителя.
Если код формата содержит только местозаполнители # слева от этого символа, числа меньше 1 начинаются с десятичного разделителя.
Чтобы всегда показывать начальный ноль с дробными числами, используйте 0 как местозаполнитель для первой цифры слева от десятичного разделителя.
%
.
Число умножается на 100.
Знак процента (%) вставляется в той позиции, где число появляется в коде формата.
E- E+ e- e+
.
Если код формата содержит хотя бы один местозаполнитель разряда (0 или #) справа от символа E-, E+, e-, или e+, такое число форматируется в экспоненциальном формате.
Буква Е или е вставляется между этим числом и экспонентой.
Количество местозаполнителей для разрядов справа от этого символа определяет количество разрядов в экспоненте.
Если экспонента является отрицательной, знак минус отображается непосредственно перед экспонентой с E-, E+, e-, e+.
Если экспонента является положительной, знак плюс отображается только перед экспонентами с Е+ или е+.
Разделитель тысяч отображается в том случае, если код формата содержит разделитель, окруженный местозаполнителями разрядов (0 или #).
Использование точки как разделителя групп разрядов или десятичного разделителя определяется параметрами региональных стандартов операционной системы.
При вводе числа непосредственно в исходный код Basic всегда используйте в качестве десятичного разделителя точку.
Фактически отображаемый в качестве десятичного разделителя символ определяется форматом чисел, заданным в системных параметрах.
- + $ ( ) пробел
.
Плюс (+), минус (-), доллар ($), пробел или скобки, расположенные непосредственно в коде формата, отображаются как символы.
Чтобы показать другие символы, необходимо предварить их обратной косой чертой (\) или заключить в кавычки ( &quot; &quot; ).
\.
Обратная косая черта показывает следующий символ в коде формата.
Символы в коде формата, которые имеют специальное значение, могут быть отображены как символы только в том случае, если они предваряются обратной косой чертой.
Сама обратная косая черта не отображается, если двойная обратная косая черта (\\) не введена в коде формата.
Элементы, которые должны предваряться обратной косой чертой в коде формата для того, чтобы они отображались как символы, - это символы для форматирования даты и времени (a, c, d, h, m, n, p, q, s, t, w, y, /, :), символы для числового форматирования (#, 0, %, E, e, запятая, точка) и символы для форматирования строк (@, & , < , > , !).
Можно также использовать следующие предопределенные числовые форматы.
За исключением &quot; General Number &quot; , все предопределенные коды формата возвращают число как десятичное с двумя десятичными разрядами.
Если используются предопределенные форматы, их имена должны быть заключены в кавычки.
Предопределенный формат
General Number
.
Числа отображаются так, как они введены.
Currency
.
Знак рубля помещается за числом, отрицательные числа заключаются в скобки.
Fixed
.
По крайней мере один разряд показывается перед десятичным разделителем.
Standard
.
Числа отображаются с разделителем групп разрядов.
Percent:
.
Число умножается на 100, и к этому числу добавляется знак процента.
Scientific
.
Числа отображаются в научном формате (например, 1,00E+03 для числа 1000).
Код формата можно разделить на три части, отделенные точками с запятой.
Первая часть определяет формат для положительных значений, вторая часть - для отрицательных, а третья часть - для нулевых.
Если задан только один код формата, он применяется ко всем числам.
Пример:
Sub ExampleFormat
MsgBox Format(6328.2, &quot; ##,##0.00 &quot; )
REM как разделитель разрядов всегда используется точка, если числа вводятся в исходном коде Basic.
REM отображает, например, 6,328.20 для английского языка, 6.328,20 для немецкого языка.
End Sub