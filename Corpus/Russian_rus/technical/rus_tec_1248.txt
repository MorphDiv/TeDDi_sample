# language_name_wals:	Russian
# language_name_glotto:	Russian
# iso639_3:	rus
# year_composed:	NA
# year_published:	NA
# mode:	written
# genre_broad:	technical
# genre_narrow:	NA
# writing_system:	Cyrl
# special_characters:	NA
# short_description:	OpenOffice
# source:	https://object.pouta.csc.fi/OPUS-OpenOffice/v3/raw/ru.zip
# copyright_short:	http://opus.nlpl.eu/OpenOffice.php
# copyright_long:	http://opus.nlpl.eu/OpenOffice.php J. Tiedemann, 2012, Parallel Data, Tools and Interfaces in OPUS. In Proceedings of the 8th International Conference on Language Resources and Evaluation (LREC 2012)
# sample_type:	whole
# comments:	NA

Определение условий
/text/swriter/01/04090200.xhp
логические выражения
формулировка условий
условия; в полях и разделах
поля; определение условий
разделы; определение условий
переменные; в условиях
данные пользователя; в условиях
базы данных; в условиях
скрытие; поля баз данных
Определение условий
полей
и
разделов
в документе.
Хотя в следующих примерах используются поля, они также применимы и к разделам.
Условия могут быть определены для следующих типов полей:
Условный текст: отображает текст А, если условие истинно, или текст Б, если условие ложно.
Скрытый текст: скрывает содержимое поля, если условие истинно.
Скрытый абзац: скрывает абзац, если условие истинно.
Любая запись и следующая запись: управляет доступом к записям базы данных.
Условие
, используя следующие значения:
TRUE
Условие всегда выполняется.
Можно также ввести любое значение, не равное 0, в качестве условного текста.
FALSE
Условие не выполняется.
Здесь также можно ввести значение 0.
Условие
пустым, условие будет считаться невыполненным.
элементы
для определения формулы, а именно: операторы сравнения, математические и статистические функции, форматы чисел, переменные и константы.
При определении условия можно использовать следующие типы переменных:
переменные $[officename]
, используемые в статистике в свойствах документа.
Другие переменные, созданные с помощью поля &quot; Задать переменную &quot; .
Переменные на основе данных пользователя
Переменные на основе содержимого полей базы данных
В выражении условия не могут использоваться внутренние переменные, такие как номера страниц и глав.
Условия и переменные
В следующих примерах используется переменная &quot; х &quot; .
x == 1 или x EQ 1
Условие истинно, если &quot; х &quot; равно 1.
x != 1 или x NEQ 1
Условие истинно, если &quot; х &quot; не равно 1.
sinx == 0
Условие истинно, если &quot; х &quot; кратно пи.
Для использования операторов сравнения со строками операнды следует заключить в двойные кавычки:
x == &quot; ABC &quot; или x EQ &quot; ABC &quot;
Проверяет, содержит ли &quot; х &quot; строку &quot; ABC &quot; (TRUE), или не содержит (FALSE).
x == &quot; &quot; или x EQ &quot; &quot;
или
!x или NOT x
Проверяет, содержит ли &quot; х &quot; пустую строку.
Оператор сравнения &quot; равно &quot; в условии должен быть представлен двумя знаками равенства (==).
Например, если переменная &quot; х &quot; определена со значением 1, условие можно ввести в виде x==1.
Сведения о пользователе
Сервис - Параметры - $[officename] - Данные пользователя
.
Данные пользователя должны быть введены в форме строк.
Запросить данные пользователя можно с помощью операторов &quot; == &quot; (EQ), &quot; != &quot; (NEQ) или &quot; ! &quot; (NOT).
В следующей таблице перечислены переменные данных пользователя и их значение.
Переменная
Значение
user_firstname
Имя
user_lastname
Фамилия
user_initials
Инициалы
user_company
Организация
user_street
Улица
user_country
Страна
user_zipcode
Почтовый индекс
user_city
Город
user_title
Звание
user_position
Должность
user_tel_work
Номер рабочего телефона
user_tel_home
Номер домашнего телефона
user_fax
Номер факса
user_email
Адрес электронной почты
user_state
Область (не во всех версиях $[officename])
Например, чтобы скрыть абзац, текст или раздел от пользователя с конкретными инициалами, например &quot; ЛМ &quot; , введите условие: user_initials== &quot; ЛМ &quot; .
Условия и поля базы данных
Можно определить условия для доступа к базам данных или полям баз данных.
Например, можно проверить содержимое поля базы данных из условия или использовать поля базы данных в логических выражениях.
В таблице приведено еще несколько примеров использования баз данных в условиях.
Пример
Значение
Database.Table.Company
Database.Table.Company NEQ &quot; &quot;
Database.Table.Company != &quot; &quot;
Условие истинно, если поле COMPANY не пусто.
(В первом примере оператор не требуется.)
!Database.Table.Company
NOT Database.Table.Company
Database.Table.Company EQ &quot; &quot;
Database.Table.Company == &quot; &quot;
Возвращает значение TRUE, если поле COMPANY пустое.
(Восклицательный знак соответствует логическому NOT.)
Database.Table.Company != &quot; Sun Microsystems &quot;
Database.Table.Company NEQ &quot; Sun Microsystems &quot;
Возвращает значение TRUE, если текущее значение в поле COMPANY - &quot; Sun Microsystems &quot; .
Database.Table.Firstname AND Database.Table.Name
Возвращает значение TRUE, если запись содержит имя и фамилию.
Обратите внимание на разницу между логическим НЕ и оператором сравнения &quot; не равно &quot; &quot; != &quot; (NEQ).
При обращении к полю базы данных в условии используйте форму &quot; Databasename.Tablename.Fieldname &quot; .
Если одно из имен содержит символ, являющийся оператором, например знак &quot; минус &quot; (-), заключите имя в квадратные скобки, например Databasename.[Table-name].Fieldname.
Никогда не используйте пробелы в имени поля.
Пример.
Скрытие пустого поля базы данных
Можно создать условие, которое скрывает пустое поле, например, если поле COMPANY пусто для некоторых записей данных.
Скрытый абзац
и введите следующее условие:
Addressbook.Addresses.Company EQ &quot; &quot;
или
NOT Addressbook.Addresses.Company
Если поле базы данных COMPANY пусто, условие истинно и абзац будет скрыт.
Сервис – Параметры – %PRODUCTNAME Writer – Знаки форматирования
и отмените выбор флажка
Поля: скрытые абзацы
.
Примеры условий в полях
В следующих примерах используется поле условного текста, однако они могут быть применены к любым полям, которые могут быть связаны с условием.
Используемый для условий синтаксис также используется для полей &quot; Скрытый текст &quot; , &quot; Скрытый абзац &quot; , &quot; Любая запись &quot; или &quot; Следующая запись &quot; .
Чтобы отобразить условный текст на основе числа страниц.
Вставка - Поля - Прочие
и откройте вкладку
Функции
.
Тип
выберите &quot; Условный текст &quot; .
Условие
введите &quot; page == 1 &quot; .
Если выполняется
введите &quot; Только одна страница &quot; .
Или
введите &quot; Несколько страниц &quot; .
Вставить
, затем нажмите кнопку
Закрыть
.
Чтобы отобразить условный текст на основе определенной пользователем переменной.
Вставка - Поля - Прочие
и откройте вкладку
Переменные
.
Тип
выберите &quot; Задать переменную &quot; .
Имя
введите &quot; Profit &quot; .
Значение
введите &quot; 5000 &quot; .
Вставить
.
Функции
и выберите &quot; Условный текст &quot; в списке
Тип
.
Условие
введите &quot; Profit < 5000 &quot; .
Если выполняется
введите &quot; Цель не достигнута &quot; .
Или
введите &quot; Цель достигнута &quot; .
Вставить
.
Чтобы изменить содержимое переменной &quot; Profit &quot; , дважды щелкните поле переменной.
Чтобы отобразить условный текст на основе содержимого поля базы данных.
Первая часть данного примера вставляет пробел между полями &quot; Имя &quot; и &quot; Фамилия &quot; в документ, а вторая часть вставляет текст, основанный на содержимом поля.
Данный пример требует зарегистрированный источник адресов в $[officename].
Вставка - Поля - Прочие
и откройте вкладку
База данных
.
Тип
выберите &quot; Поля слияния &quot; .
Выбор базы данных
дважды щелкните адресную книгу, щелкните &quot; Имя &quot; , затем нажмите кнопку
Вставить
.
Повторите то же для поля &quot; Фамилия &quot; .
Поля
.
Функции
и выберите &quot; Условный текст &quot; в списке
Тип
.
Условие
введите: &quot; Addressbook.addresses.firstname &quot; .
Если выполняется
введите пробел и оставьте поле
Или
пустым.
Теперь можно использовать условие, чтобы вставить текст на основе содержимого поля &quot; Имя &quot; .
Поля
откройте вкладку
Функции
.
Тип
выберите &quot; Условный текст &quot; .
Условие
введите:
Addressbook.addresses.firstname == &quot; Михаил &quot;
Если выполняется
введите &quot; Уважаемый &quot; .
Иначе
введите &quot; Добрый день &quot; .
Вставить
.