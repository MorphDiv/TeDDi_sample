# language_name_wals:	Russian
# language_name_glotto:	Russian
# iso639_3:	rus
# year_composed:	NA
# year_published:	NA
# mode:	written
# genre_broad:	technical
# genre_narrow:	NA
# writing_system:	Cyrl
# special_characters:	NA
# short_description:	KDE4
# source:	https://object.pouta.csc.fi/OPUS-KDE4/v2/raw/ru.zip
# copyright_short:	http://opus.nlpl.eu/KDE4.php
# copyright_long:	http://opus.nlpl.eu/KDE4.php J. Tiedemann, 2012, Parallel Data, Tools and Interfaces in OPUS. In Proceedings of the 8th International Conference on Language Resources and Evaluation (LREC 2012)
# sample_type:	whole
# comments:	NA

Marco Menardi gnu@ kde. org
Алексей Опарин opaleksej@ yandex. ru Перевод на русский
Общий доступ к данным с помощью & kontact; через IMAP
Введение
Я долго не мог найти приемлемое для моего маленького офиса PIM - решение, которое позволяло бы нам с моим секретарём иметь общий доступ к данным о наших контактах, намеченных встречах и т. п. Будучи пользователем & kde;, я знал о проекте Kroupware и ожидал его завершения. Но, увидев, насколько сложна архитектура и настройка Kolab сервера 1. 0 (серверной части проекта), решил воздержаться и дождаться выхода Kolab 2. 0 с более простым развертыванием. И всё- таки, возможности Kolab для моих скромных потребностей были явно избыточны. Но вот однажды на форуме & kde; я встретил обсуждение, в котором упоминалось о возможности общего доступа к данным без использования Kolab... ого, это интересно!
Оказывается, в маленьких офисах можно обойтись без установки Kolab сервера или других groupware- решений, воспользовавшись одним & kontact;. Он может работать с обычным, простым в настройке IMAP - сервером.
Описываемые действия я проводил на платформе Debian unstable и & kde; 3. 4. К & kontact; и другим легендарным GNU/ Linux приложениям я обращался из Window$ с помощью Cygwin/ X, в ожидании того момента, когда проект Wine сделает возможным запуск всех необходимых мне Windows- программ (не имеющих подходящих аналогов под GNU/ Linux таких не было). Итак, мне нужно было обеспечить общий с моим секретарём доступ к данным о контактах, событиях, намеченных мероприятиях.
Что такое IMAP
Вот определение из словаря ComputerUser. com High- Tech Dictionary: Internet Message Access Protocol. Протокол, позволяющий пользователю производить некоторые почтовые операции на удалённом сервере. С помощью IMAP пользователь может создавать, удалять и переименовывать почтовые ящики; получать и удалять сообщения; выполнять поиск по почте. Для отправки почты требуется отдельный протокол. Другой вариант расшифровки -- Internet Mail Access Protocol.
Значит, этот протокол можно рассматривать как интерфейс к накопителю со специфическими функциями доступа. Чтобы использовать его, нужен сервер IMAP, такой как Cyrus, Courier или UW.
Kolab или IMAP?
Kolab даёт возможность общего доступа к данным для разных клиентов. Например, ваш секретарь может пользоваться Outlook, а вы -- & kontact;.
Вы получаете интерфейс настройки, позволяющий управлять учётными записями пользователей, настраивать почтовые учётные записи, общий сервер конфигурации LDAP и адресной книги, фильтры спама и вирусов, управление графиком отпусков, режимом труда и отдыха, ресурсами (номера в гостиницах, автомобили), список адресатов и групп, автоматическое напоминание и т. д.
Однако, всё это очень сложно в установке и настройке. Для новичка вроде меня это означает нескончаемые ночные бдения и массу проблем, прежде чем все заработает. Нет уж, спасибо, лучше я попробую IMAP, он попроще.
Как настроить IMAP - сервер Cyrus
Я выбрал Cyrus, это часть пакета программ Kolab, поэтому, если будет суждено перейти на Kolab в будущем, по крайней мере я буду с ним знаком.
Итак, приступим к установке и настройке!
Становимся root.
# apt- get install cyrus21- imapd cyrus21- common cyrus21- admin cyrus21- client sasl- bin sasl2- bin Installing cyrus21- imapd... Программа установки спрашивала что- то о search address... Я просто нажал Enter и всё заработало.
Программа установки создаёт пользователя cyrus, принадлежащего к автоматически созданной группе sasl, которая является владельцем всех файлов cyrus. После завершения установки с помощью ps - A можно увидеть новые процессы: cyrmaster и notifyd.
Трудности встретились в настройке идентификации Cyrus, просто потому что я новичок с ограниченным знанием предмета.
Cyrus может использовать различные механизмы SASL (Simple Authentication and Security Layer). По умолчанию установлен sasldb (он сохраняет имена пользователей и пароли в файле sasldb), но поддерживаются также getpwent, kerberos4, kerberos5, PAM, rimap, shadow и LDAP.
Не желая менять уже имеющиеся имена и пароли, я выбрал механизм shadow, позволяющий использовать для идентификации в Cyrus пароли & Linux;.
Чтобы сделать это, необходимо сообщить sasl об использовании saslauthd в качестве метода авторизации, затем настроить saslauthd на использование shadow (или getpwent) как механизма идентификации.
OK, начнём!
Как root, измените системный пароль пользователя cyrus:
# passwd cyrus
Введите пароль, который вам понравится (и который сможете запомнить), в моём примере использован cyrus как пароль администратора приложения cyrus.
# vi / etc/ imapd. conf
sasl_ pwcheck_ method: saslauthd вместо стоящего по умолчанию auxprop
удалите знак # в начале строки:
# admins: cyrus
таким образом пользователь cyrus может распоряжаться учётной записью cyrus.
# vi / etc/ default/ saslauthd
Раскомментируйте строку:
# START=yes
(иначе saslauthd не будет запускаться при загрузке, даже будучи указанным где- нибудь в / etc/ rcx. d!)
и вместо MECHANISMS=" pam "введите MECHANISMS=" shadow", таким образом при загрузке будет выполняться команда saslauthd - a shadow.
Выйдя из редактора, перезапустите sasl и cyrus.
Для проверки IMAP:
su cyrus $imtest - m login - p imap localhost
Предлагается ввести пароль для cyrus, так введём его.
Если пользователь cyrus правильно идентифицирован, появятся следующие строки:
S: L01 OK User logged in Authenticated.
Для выхода наберите. logout (точка, пробел, logout)
Теперь с помощью обычных системных средств создадим пользователя groupware и установим для него пароль. Он должен принадлежать к какой- нибудь непривилегированной группе, например nobody, ему не нужны системная оболочка и домашняя папка.
Создадим пользователя и IMAP также и в cyrus:
# cyradm -- user cyrus localhost после ввода пароля администратора cyrus, получим приглашение localhostgt; localhostgt; cm user. groupware localhostgt; lm выводит только что созданный почтовый ящик user. groupware (\\ HasNoChildren)) localhostgt; quit
Для вывода списка доступных команд можно набрать help.
Посмотрим, что у нас получилось:
# ls - l / var/ spool/ cyrus/ mail/ g/ user/ groupware total 12 - rw ------- 1 cyrus mail 4 Oct 29 20: 55 cyrus. cache - rw ------- 1 cyrus mail 155 Oct 29 20: 55 cyrus. header - rw ------- 1 cyrus mail 76 Oct 29 20: 55 cyrus. index
Теперь можно попробовать подключиться IMAP - клиентом как пользователь groupware и заглянуть в папку INBOX.
В протоколе IMAP название почтового ящика INBOX служит ключевым словом, это в нектором роде псевдоним структуры каталога выше. Клиент заходит во INBOX, а сервер IMAP перенаправляет его в папку / var/ spool/ cyrus/ mail /... с её файлами- сообщениями.
Настройка клиентов & kontact;
Я подключаюсь к моему офисному серверу с GNU/ Linux (это "black box", без клавиатуры и монитора) с двух компьютеров с & Windows; 2000 с помощью Cygwin/ X, используя их как X- Window сервер (в ближайшем будущем надеюсь заменить их на два тонких клиента mini- itx под управлением). В этой конфигурации каждый пользователь запускает & kontact; на той машине, на которой установлен и запущен Cyrus (localhost).
Чтобы & kontact; работал с IMAP, предпримем следующее:
Создадим учётную запись IMAP в Cyrus для мнимого пользователя groupware (это мы уже сделали)
Создадим и настроим учётную запись IMAP в & kmail; для входа этого пользователя
Используйте kresources для того чтобы заставить компоненты & kontact; работать с данными, взятыми из источника IMAP
Включим функции groupware и создадим соответствующие подпапки в INBOX (если их там ещё нет)
Приятной работы с новыми друзьями & kontact;, Cyrus и IMAP!
Итак, войдём в & kde; с учётной записью первого реального пользователя, которому мы хотим предоставить функциональность groupware.
Создаём учётную запись IMAP в & kmail;.
Запустим & kontact; и найдём Почта (компонент & kmail;). В меню выбираем: Настройка Настроить KMail Учётные записи, переходим на вкладку Получение. Нажмём кнопку Добавить.... Будет задан вопрос о типе почтовой учётной записи, выберите Отсоединённый IMAP (а не просто IMAP). Затем на вкладке Общие введём следующие данные:
Учётное имя: office_ gwdata
Так будет названа локальная папка, указывающая на эту учётную запись IMAP.
Имя: groupware
Пользователь Cyrus, избранный владельцем всех офисных данных
Пароль:
Пароль пользователя groupware.
Сервер: localhost
Помним, в нашем примере клиент & kontact; действует на том же компьютере, что и IMAP сервер
Порт: 143
По умолчанию
Отметьте галочкой Хранить пароль IMAP в файле настроек, чтобы не вводить его снова и снова. Отметьте также Периодическая проверка почты и задайте значение в минутах.
Заметьте, что выбран тип учётной записи Отсоединенный IMAP. В этом случае копии данных groupware хранятся локально по отношению к клиенту (в его домашней папке) и синхронизируются при каждом его подключении. На первый взгляд, это очень неэффективно, так как данные многократно дублируются (например, на 10 пользователей & kontact; будет 10+1 копий данных). Но это единственная возможность добиться высокой скорости, ведь & kontact; при каждом подключении доставляет все данные и заставляет & korganizer; и & kaddressbook; обрабатывать их. Если же при Отсоединенном IMAP данные хранятся в одном месте, пересылаются только delta (изменённые) данные.
С другой стороны, если пользователи работают с & korganizer; на той же машине, что IMAP сервер, может показаться более разумным выбрать режим IMAP (так называемый онлайн IMAP) для экономии места, если скорость передачи не очень важна. К несчастью, этот способ не действует, потому что & kontact; в режиме IMAP не может автоматически обновлять папку Календарь. Поэтому, когда кто- нибудь добавляет в эту папку данные, общего обновления не происходит (необходимо вручную включать приложение & kmail; и щёлкать на папке Календарь). Кроме того, когда при пуске начинается чтение папок Календарь, происходит ужасное мигание и замедление обновления данных.
Теперь в & kontact; можно использовать IMAP как основной источник данных. Из & kmenu;, выберите Выполнить программу, введите kcmshell4 kresources. В выпадающем списке выберите Контакты, затем нажмите кнопку Добавить... и выберите Адресная книга на сервере IMAP через KMail. Затем выделяем эту новую строку и нажимаем кнопку Использовать как стандартный. Сделаем то же самое для пунктов Календарь и Заметки.
Теперь включите функциональность groupware в & kmail; (а следовательно, в всём & kontact;):
Выберите в меню Настройка Настроить KMail Разное Совместная работа
Отметьте Включить функциональность IMAP
Выберите Английский как Язык папок совместной работы (на тот случай, если на сервере IMAP уже есть папки, созданные другой программой на другом языке).
Теперь перейдём к Корневая папка ресурсов и выберем подпапку Inbox в папке office_ gwdata.
Пункт Скрыть папки совместной работы оставим пока неотмеченным и посмотрим, что из этого получится. В дальнейшем, когда окончательно во всём разберёмся, можно будет вернуться и отметить его.
Нажав OK, получаем предложение: kmail; создаст требуемые папки для ресурса IMAP как подпапки Inbox
Если нам этого не нужно, нажмём Нет, и ресурсы IMAP будут удалены. Нажмём Да (эта возможность появляется только раз, для первого реального пользователя). Тут же можно заметить, как в дереве папок & kmail; в папках office_ gwdata Inbox создаются эти подпапки.
Календарь
Контакты
Заметки
Задачи
Журнал
если вы сейчас сделаете:
# ls - l / var/ spool/ cyrus/ mail/ g/ user/ groupware / drwx ------ 2 cyrus mail 144 Oct 31 16: 36 Calendar drwx ------ 2 cyrus mail 144 Oct 31 16: 36 Contacts drwx ------ 2 cyrus mail 144 Oct 31 16: 36 Journal drwx ------ 2 cyrus mail 144 Oct 31 16: 36 Notes drwx ------ 2 cyrus mail 144 Oct 31 16: 36 Tasks - rw ------- 1 cyrus mail 4 Oct 31 15: 28 cyrus. cache - rw ------- 1 cyrus mail 155 Oct 29 20: 55 cyrus. header - rw ------- 1 cyrus mail 76 Oct 31 15: 28 cyrus. index
Как можно заметить, office_ gwdata Inbox находится не в домашней директории пользователя & kontact;, а в папках пользователей IMAP groupware.
Теперь & kontact; готов к работе и хранению данных в этих папках. В календаре, если учётная запись & kmail; IMAP имела тип Отсоединённый, в окне Ресурс должен быть виден пункт Imap- ресурс с тремя подпунктами, которые являются путями к локальным домашним файлам. А вот в пункте Контакты подпунктов в Imap- ресурс нет.
Теперь можно войти в & kde; под именем другого пользователя, и подобным же образом настроить его/ её клиент & kontact;.
Откройте & kontact;, и в компоненте Письмо добавьте учётную запись IMAP, указав в качестве Сервер компьютер, на котором установлен Cyrus сервер (в моём случае: 192. 168. 1. 3).
Не забудьте поставить флажок Периодическая проверка почты и установить значение в минутах. Когда вы подтвердите свои действия, вопрос о создании подпапок задан не будет (ведь они уже созданы на сервере IMAP), их можно увидеть в дереве папок.
Активируйте функциональность groupware для получения возможности сохранять данные на сервере IMAP.
Помните, что в режиме Отсоединённый IMAP данные передаются от клиента на сервер IMAP только тогда, когда клиент подключается для проверки почты. Поэтому, если у ваших клиентов & kontact; Интервал между проверками установлен, например, 5 минут, то в худшем случае задержка между записью события и его появлением перед другими пользователями составит 10 минут.
Как установить доступ только для чтения
Хочу предупредить, что реализация Заметок IMAP в & kontact; вплоть до версии 1. 01 была неустойчивой, поэтому описанные настройки с прежними версиями могут не работать. Если вы хотите пользоваться этими версиями, понадобятся настройки, существовавшие ранее.
В этих прежних настройках существует тот же мнимый пользователь под именем groupware, имя и пароль которого применяют все реальные пользователи & kontact; (т. е. tony, rohn, amanda и т. д.) через учётную запись IMAP. Но таким образом все реальные пользователи имеют одинаковые права чтения/ записи, так как каждый подключается к IMAP серверу как пользователь groupware.
Для ограничения доступа некоторым пользователям (обычно, предоставляется доступ только для чтения), можно воспользоваться ACL (Access Control Lists).
В & kmail; выберите подпапку office_ gwdata, например, Календарь, и, щелкнув на ней правой кнопкой мыши, выберите пункт Параметры, вкладку Контроль доступа. Здесь можно указать, каким пользователям и какие права доступа к этой папке вы хотите предоставить.
Ради эксперимента, дадим права All пользователю mary
Сначала на уровне приложения cyrus (на той машине, на которой размещен IMAP сервер cyrus, средствами приложения cyrus) добавим пользователя mary, чтобы этого пользователя мог опознать IMAP, и создадим для неё IMAP папку.
Затем входим в GNU/ Linux как mary и переходим в & kontact;. Как мы видели прежде, учётную запись IMAP в & kmail; вы можете настроить как один из пользователей (вместо мнимого пользователя groupware и его пароля, мы можем использовать имя mary и её пароль).
На этот раз в дереве папок & kmail; вы увидите следующую структуру: office_ gwdata user groupware Календарь и Задачи. Проверьте почту (Файл Проверить почту), и вы также увидите папку входящие под папкой office_ gwdata.
Теперь включим возможности groupware & kmail;, и в Папки IMAP есть подпапки: укажем Входящие, которая является подпапкой office_ gwdata.
У нас появились две ветви папок в office_ gwdata:
Входящие с папками Календарь, Контакты, Заметки, Задачи и Журнал, которые хранятся в папках mary IMAP на IMAP сервере
user, с подпапкой groupware и подпапками, к которым имеет доступ mary (в нашем примере, Календарь и Задачи)
Правой кнопкой мыши щёлкнем user Календарь и проверим, имеет ли он тип Календарь (если нет, то установим его как надо). Так же поступим с папкой user Задачи.
Теперь в Календаре у вас есть два возможных IMAP - ресурса для записи, поэтому, когда вы создадите новое событие, вам будет задан вопрос, какой из них использовать (а если оставлены доступными локальные ресурсы, придётся выбирать из трёх!).
Нужно переместить курсор в нижнее левое маленькое окошко Календаря, которое показывает доступные ресурсы, и снять отметку с тех, что не указывают на. groupware. directory (см. хвостовую часть пути к ресурсу).
Благодарности
Я новичок, и смог вложить в это руководство только свои время и желание. Реальными же знаниями я обязан некоторым наставникам из мира свободного ПО, которых хочу поблагодарить за компетенцию, терпение и готовность прийти на помощь.
Особая благодарность:
За часть Cyrus IMAP в # cyrus channel:
[protagonist] Энди Моргану (Andy Morgan) morgan@ orst. edu
[plixed] Окке Тимму (Okke Timm) okke. timm@ web. de
За часть & kontact; в # kontact channel:
[till] Тиллю Адаму (Till Adam) adam@ kde. org
[dfaure] Дэвиду Фору (David Faure) faure@ kde. org
[mdouhan] Мэтту Духану (Matt Douhan matt@ fruitsalad. org
Благодарю всех своих наставников!
Ах, да, вот ещё я, [markit] Марко Менарди (Marco Menardi) mmenaz@ mail. com
Дополнительные сведения
Ссылки
KDE: http: // www. kde. org
Веб- сайт & kontact;: http: // www. kontact. org
Проект Kroupware: http: // www. kroupware. org
Форум Сообщества & kde;: http: // wiki. kde. org
Проект Wine: http: // www. winehq. org
Проект Cygwin/ X: http: // x. cygwin. com
Проект LTSP: http: // www. ltsp. org
Теперь включим функциональность groupware & kmail;, и в Папки IMAP есть подпапки: укажем Входящие, которая является подпапкой office_ gwdata.