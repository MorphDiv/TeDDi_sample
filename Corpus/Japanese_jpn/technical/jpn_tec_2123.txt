# language_name_wals:	Japanese
# language_name_glotto:	Japanese
# iso639_3:	jpn
# year_composed:	NA
# year_published:	NA
# mode:	written
# genre_broad:	technical
# genre_narrow:	NA
# writing_system:	Jpan
# special_characters:	NA
# short_description:	OpenOffice
# source:	https://object.pouta.csc.fi/OPUS-OpenOffice/v3/raw/ja.zip
# copyright_short:	http://opus.nlpl.eu/OpenOffice.php
# copyright_long:	http://opus.nlpl.eu/OpenOffice.php J. Tiedemann, 2012, Parallel Data, Tools and Interfaces in OPUS. In Proceedings of the 8th International Conference on Language Resources and Evaluation (LREC 2012)
# sample_type:	whole
# comments:	NA

データベース関数
/text/scalc/01/04060101.xhp
関数ウィザード; データベース
関数; データベース関数
データベース; $[officename] Calc の関数
データベース関数
ここでは、データベース (1 行のデータを 1 つのレコードと見なす) のデータを処理する関数について説明します。!
Database カテゴリは、$[officename] に統合されているデータベースと混同される場合があります。$[officename] のデータベースと $[officename] Calc の Database カテゴリとの間に関連はありません。
データ例:
ここでは、いくつかの関数を説明するときに次のデータを例として使用します。
範囲 A1:E10 は Joe 君の誕生日パーティに招待した子供のリストです。各エントリには次のような情報が提供されています。列 A には名前、B には学年、年齢、通学路 (メートル)、および体重 (キログラム) が入っています。
A
B
C
D
E
1
名前
学年
年齢
学校への距離
体重
2
Andy
3
9
150
40
3
Betty
4
10
1000
42
4
Charles
3
10
300
51
5
Daniel
5
11
1200
48
6
Eva
2
8
650
33
7
F
ランク
2
7
3
00
4
2
8
Greta
1
7
200
36
9
Harry
3
9
1200
44
10
Irene
2
8
1000
42
11
12
13
名前
学年
年齢
学校への距離
体重
14
> 600
15
16
DCOUNT
5
セル B16 の数式は、=DCOUNT(A1:E10;0;A13:E14) です。
データベース関数のパラメータ:
次に示す項目は、全データベース関数のパラメータ定義です。
データベース
は、データベースとして使用するセル範囲です。
データベースフィールド
は、最初のパラメータの検索条件が適用され、データ行が選択されたあとに関数が実行される列を指定します。検索条件自体には関係しません。データ範囲全体を指定するには、数字 0 を使用します。
列ヘッダー名で列を参照するには、ヘッダー名を引用符で囲みます。
検索条件
は、検索条件を含むセル範囲です。1 行に複数の条件を書き込むと、それらは AND で結合されます。異なる行に条件を書き込むと、それらは OR で結合されます。検索条件範囲内の空白セルは、無視されます。
ツール → オプション → %PRODUCTNAME Calc → 計算
を選択し、同じエントリを検索するときの $[officename] Calc の動作を定義します。
条件付き計算と合計
については、Wiki ページも参照してください。
DCOUNT 関数
行のカウント; 数値が入った行
mw added &quot; counting rows; &quot;
DCOUNT
DCOUNTは、検索条件に一致する数値を含むデータベース内の行 (レコード) 数を返します。
構文
DCOUNT(データベース; データベースフィールド; 検索条件)
例
=DCOUNT(A1:E10;0;A13:E14)
を入力します。範囲の入力には、
関数ウィザード
が役立ちます。
データベース
は、ヘッダーを含む評価対象のデータ範囲です。この場合は、A1:E10 です。
データベースフィールド
は、検索条件の列を指定します。この場合は、データベース全体です。
検索条件
は、検索パラメータを入力できる範囲です。この場合は、A13:E14 です。
2
を入力し、右のセル C14 に
> 7
を入力します。結果は 2 です。2 人の子供が 2 年生で 7 歳を過ぎています。両方の条件は同じ行内にあるので、AND によって結合されます。
DCOUNTA 関数
レコード数; Calc データベース内のカウント
行のカウント; 英数値を含む
mw added &quot; records; &quot; and &quot; counting rows; &quot;
DCOUNTA
DCOUNTA は、検索条件に一致する数値またはアルファベット値を含むデータベース内の行 (レコード) 数を返します。
構文
DCOUNTA(データベース; データベースフィールド; 検索条件)
例
=DCOUNTA(A1:E10; &quot; Name &quot; ;A13:E14)
に編集します。古い検索条件を削除し、フィールド A14 の Name の下に
> =E
を入力します。結果は 5 です。行 8 の Greta のすべての数値を削除すると、結果は 4 に変わります。行 8 は値を何も含んでいないので、カウントされなくなります。名前 Greta はテキストで、値ではありません。データベースフィールドパラメータは、値を含むことができる列を指す必要があります。
DGET 関数
セルの内容;Calc データベース内の検索
検索;Calc データベース内のセルの内容
mw added &quot; cell contents; &quot; and &quot; searching; &quot;
DGET
DGET は、検索条件に一致する、データベース内の 1 つのセルの内容を返します。
セルが見つからない場合は #VALUE! を、2 つ以上のセルが見つかると エラー:
502 を返します。
構文
DGET(データベース; データベースフィールド; 検索条件)
例
データベースフィールド
には 1 列 (1 つのデータベースフィールド) しか入力できないので、数式はセル B16 に入力され、前の例とは少し異なります。次の数式を入力します:
=DGET(A1:E10; &quot; Grade &quot; ;A13:E14)
Frank
を入力すると、結果 2 が表示されます。Frank は 2 年生です。 &quot; Grade &quot; の代わりに
&quot; Age &quot;
を入力すると、Frank の年齢が表示されます。
11
を入力して、この行のほかの入力を削除します。B16 の数式を次のように編集します:
=DGET(A1:E10; &quot; Name &quot; ;A13:E14)
学年のかわりに名前が検査されます。11歳の子供は Daniel １人です。
DMAX 関数
Calc データベース内の最大値
検索;列内の最大値
mw added &quot; maximum... &quot; and &quot; searching; &quot;
DMAX
DMAX は、検索条件を満たすデータベース内のすべての行 (レコード) の中からセル (フィールド) の最大値を返します。
構文
DMAX(データベース; データベースフィールド; 検索条件)
例
各学年で最も重い子供の体重を知るには (上にスクロールしてください)、次の数式をセル B16 に入力します。
=DMAX(A1:E10; &quot; Weight &quot; ;A13:E14)
1、2、3
などを順に入力します。学年番号を入力すると、その学年でもっとも重い子供の体重が表示されます。
DMIN 関数
Calc データベース内の最小値
検索; 列内の最小値
mw added &quot; minimum... &quot; and &quot; searching; &quot;
DMIN
DMIN は、データベースにおいて検索基準を満たす行のうち、データベースフィールドの最小値を返します。
構文
DMIN(データベース; データベースフィールド; 検索条件)
例
各学年で通学路が最も短い子供を知るには (上にスクロールしてください)、次の数式をセル B16 に入力します。
=DMIN(A1:E10; &quot; Distance to School &quot; ;A13:E14)
1、2、3
などを順に入力します。各学年の学校への最短距離が表示されます。
DAVERAGE 関数
平均; Calc データベース内
計算; Calc データベース内の平均
mw added &quot; averages;... &quot; and &quot; calculating; &quot;
DAVERAGE
DAVERAGE は、データベース内で、検索条件を満たすすべての行 (データベースレコード) のすべてのセル (フィールド) の内容の平均値を返します。
構文
DAVERAGE(データベース; データベースフィールド; 検索条件)
例
年齢が同じ子供たち全員の平均体重を知るには (上にスクロールしてください)、次の数式をセル B16 に入力します。
=DAVERAGE(A1:E10; &quot; Weight &quot; ;A13:E14)
7、8、9
などを順に入力します。年齢が同じ子供たち全員の平均体重が表示されます。
DPRODUCT 関数
乗算; Calc データベース内のセルの内容
mw added &quot; multiplying... &quot;
DPRODUCT
DPRODUCT は、セルの内容が検索条件を満たすデータ範囲の、すべてのセルの積を返します。
構文
DPRODUCT(データベース; データベースフィールド; 検索条件)
例
上記誕生日パーティの例では (上にスクロールしてください)、この関数は有効に使用できません。
DSTDEV 関数
データベース内の標準偏差; ひとつの標本にもとづく
mw added &quot; standard deviations...; &quot;
DSTDEV
DSTDEV は、データベースにおいて検索基準を満たす行のうち、データベースフィールドの値の標本をとって、母集団の標準偏差を計算します。
つまり、DSTDEV はレコードをデータの標本として扱います。つまり、上記例の子供はすべての子供の典型です。ただし、1000 人に満たない標本だけでは本当の典型にはなり得ません。
構文
DSTDEV(データベース; データベースフィールド; 検索条件)
例
年齢が同じ子供たち全員の体重の標準偏差を求めるには (上にスクロールしてください)、次の数式をセル B16 に入力します。
=DSTDEV(A1:E10; &quot; Weight &quot; ;A13:E14)
7、8、9
などを順に入力します。表示される結果は、この年齢の子供たち全員の体重の標準偏差です。
DSTDEVP 関数
データベース内の標準偏差; 母集団にもとづく
mw added &quot; standard deviations...; &quot;
DSTDEVP
DSTDEVP は、検索基準を満たすデータ範囲内のすべてのセルに基づいて、母集団の標準偏差を計算します。
つまり、DSTDEVP はレコードを母集団全体として扱います。
構文
DSTDEVP(データベース; データベースフィールド; 検索条件)
例
ジョーの誕生パーティに参加した、年齢が同じ子供たち全員の体重の標準偏差を求めるには (上にスクロールしてください)、次の数式をセル B16 に入力します。
=DSTDEVP(A1:E10; &quot; Weight &quot; ;A13:E14)
7、8、9
などを順に入力します。結果は、体重を検査された同年齢の子供たち全員の体重の標準偏差です。
DSUM 関数
計算; Calc データベース内の合計
合計; Calc データベース内のセル
mw added &quot; calculating; &quot; and &quot; sums; &quot;
DSUM
DSUM は、入力された検索条件を満たすすべての行 (レコード) のデータベースフィールドの、すべてのセルの合計を返します。
構文
DSUM(データベース; データベースフィールド; 検索条件)
例
Joe の誕生日パーティに参加した子供たちのうち、2 年生全員の通学路の合計距離を求めるには (上にスクロールしてください)、次の数式をセル B16 に入力します:
=DSUM(A1:E10; &quot; Distance to School &quot; ;A13:E14)
2
を入力します。2 年生の子供たち全員の学校への距離の合計 (1950) が表示されます。
DVAR 関数
分散; 標本にもとづく
mw added &quot; variances; &quot;
DVAR
DVAR は、データベースにおいて検索条件を満たす行のうち、データベースフィールドの値の標本をとって、平方偏差を計算します。
つまり、DVAR はレコードをデータの標本として扱います。ただし、1000 人に満たない標本だけでは本当の典型にはなり得ません。
構文
DVAR(データベース; データベースフィールド; 検索条件)
例
年齢が同じ子供たち全員の体重の平方偏差を求めるには (上にスクロールしてください)、次の数式をセル B16 に入力します
=DVAR(A1:E10; &quot; Weight &quot; ;A13:E14)
7、8、9
などを順に入力します。結果として、この年齢の子供たち全員の体重値の分散が表示されます。
DVARP 関数
分散; 母集団にもとづく
mw added &quot; variances; &quot;
DVARP
DVARP は、データベースにおいて検索条件を満たす行のうち、データベースフィールドのすべての値を使用して、平方偏差を計算します。
つまり、DVARP はレコードを母集団全体として扱います。
構文
DVARP(データベース; データベースフィールド; 検索条件)
例
Joe の誕生日会に招待された同年齢の子供全員の体重の標本分散を検査します (上にスクロールしてください)。B16 に次の数式を入力します:
=DVARP(A1:E10; &quot; Weight &quot; ;A13:E14)
7、8、9
などを順に入力します。Joe の誕生日パーティーに参加する、この年齢の子供たち全員の体重値の分散が表示されます。