# language_name_wals:	Japanese
# language_name_glotto:	Japanese
# iso639_3:	jpn
# year_composed:	NA
# year_published:	NA
# mode:	written
# genre_broad:	technical
# genre_narrow:	NA
# writing_system:	Jpan
# special_characters:	NA
# short_description:	OpenOffice
# source:	https://object.pouta.csc.fi/OPUS-OpenOffice/v3/raw/ja.zip
# copyright_short:	http://opus.nlpl.eu/OpenOffice.php
# copyright_long:	http://opus.nlpl.eu/OpenOffice.php J. Tiedemann, 2012, Parallel Data, Tools and Interfaces in OPUS. In Proceedings of the 8th International Conference on Language Resources and Evaluation (LREC 2012)
# sample_type:	whole
# comments:	NA

条件を設定する
/text/swriter/01/04090200.xhp
論理式
条件式の作成
条件式; フィールドやセクションで使用
フィールド;条件式の定義
セクション;条件式の定義
変数; 条件式で使用
ユーザーデータ;条件式で使用
データベース;条件式で使用
非表示; データベースフィールド
条件を設定する
フィールド
や
セクション
の表示を制御する際に使用します。ここでの解説では例としてフィールドを使用していますが、セクションの場合でも同様です。
条件は、次の種類のフィールドに設定できます。
条件付きテキスト:条件が真の場合はテキスト A を表示し、条件が偽の場合はテキスト B を表示します。
隠しテキスト:条件が真の場合、フィールドの内容を隠します (表示しません)。
隠し段落:条件が真の場合、段落の内容を隠します (表示しません)。
任意のレコードと次のレコード:データベースレコードへのアクセスを制御します。
条件
に論理表現を直接入力することです。
TRUE
条件は常に満たされます。0 に等しくない任意の値を条件テキストとして指定することもできます。
FALSE
条件は満たされません。0 値を指定することもできます。
条件
を空のままにした場合、条件は「満たされない」ものであると見なされます。
構成要素
である、比較演算子、数学関数、統計関数、数の書式、変数、定数なども利用します。
条件を定義するときには、次の種類の変数を使用できます。
$[officename] の定義済み変数
(ドキュメントのプロパティーで得られる統計情報)
ユーザー定義の変数 (「変数の設定」フィールドで作成する)
ユーザーデータに基づく変数
データベースフィールドの内容に基づく変数
ページ番号や章番号などの内部変数は条件式には使用できません。
条件と変数
次の例では、変数「x」を使用しています。
x== 1 または x EQ 1
変数「x」が 1 に等しい場合、条件は真になります。
x != 1 または x NEQ 1
変数「x」が 1 に等しくない場合、条件は真になります。
sinx == 0
変数「x」がパイの倍数である場合、条件は真になります。
比較演算子を文字列と一緒に使用するには、演算子を二重引用符で囲む必要があります。
x == &quot; ABC &quot; または x EQ &quot; ABC &quot;
変数「x」に文字列「ABC」が含まれているか (True)、そうでないか (false) を判定します。
x == &quot; &quot; または x EQ &quot; &quot;
あるいは
! x または NOT x
変数「x」に空の文字列が含まれている場合は真になります。
「等しい」ことを示す比較演算子を条件で使用する場合、2 つの等号記号 (==) で表現する必要があります。たとえば、値 1 を持つ変数「x」を定義した場合、「FALSE x==1」という条件を入力できます。
ユーザーデータ
ツール → オプション → $[officename] →ユーザーデータ
を選択します。ユーザーデータは文字列の形式で入力する必要があります。ユーザーデータを照会するときには、「== (EQ)」、「!= (NEQ)」、または「!
(NOT)」を使用できます。
次の表に、ユーザーデータの変数とその意味を示します。
変数
説明
user_firstname
名
user_lastname
姓
user_initials
イニシャル
user_company
会社
user_street
住所
user_country
国名
user_zipcode
郵便番号
user_city
都道府県名
user_title
肩書き
user_position
部署
user_tel_work
勤務先の電話番号
user_tel_home
自宅の電話番号
user_fax
ファックス番号
user_email
E-Mail アドレス
user_state
州名 (officename] のバージョンによって異なります)
たとえば、特別なイニシャル (たとえば、「LM」) を持つユーザーの場合にのみ、段落、テキスト、またはセクションを隠すには、次の条件を入力します。user_initials== &quot; LM &quot; .
条件とデータベースフィールド
条件式中では、データベース内のデータベースフィールドにアクセスすることもできます。たとえば条件式を用いて、データベースフィールドの内容を判定させたり、論理式の演算対象として、データベースフィールドを指定することができます。次の表は、条件式中でのデータベースの使用例を簡単にまとめたものです。
例
意味
データベース.テーブル.会社
データベース.表.会社 NEQ &quot; &quot;
データベース.表.会社 != &quot; &quot;
データベースフィールド「会社」が空ではない場合、条件は真になります。(最初の例では、演算子は必要ありません。)
!データベース.表.会社
NOT データベース.テーブル.会社
データベース.表.会社 EQ &quot; &quot;
データベース.表.会社 == &quot; &quot;
COMPANY フィールドが空の場合、TRUE を返します。(感嘆符は論理否定を表します。)
データベース.表.会社 != &quot; Sun Microsystems &quot;
データベース.表.会社 NEQ &quot; Sun Microsystems &quot;
データベースフィールド「会社」の現在の値が「Sun Microsystems」である場合、TRUE を返します。
データベース.テーブル.名 AND データベース.テーブル.姓
レコードに最初の名前と最後の名前が入っている場合、TRUE を返します。
論理否定 &quot; ! &quot; (NOT) と比較演算子「等しくない」 &quot; != &quot; (NEQ) との違いに注意してください。
条件式中でデータベースフィールドを参照する場合は、「データベース名.表名.フィールド名」の形式で指定します。これらの名前の中に、マイナス記号 (-) などの演算子と重なる記号が使われている場合は、「Databasename.[Table-name].Fieldname」のように、名前を大かっこで囲みます。なお、フィールドの名前の中にはスペース記号は使えません。
例:空のデータベースフィールドを隠す
必要であれば、空のフィールドを表示しない条件も作成できます。たとえば、いくつかのデータレコードのうち、フィールド「会社」が空の場合には、次のように入力します。
隠し段落
リスト項目を選択し、次の条件を入力します: アドレス帳.アドレス.会社 EQ &quot; &quot;
あるいは、次のように入力します。
NOT アドレス帳.アドレス.会社
フィールド「会社」が空の場合、条件は真になり、段落は隠されます。
ツール → オプション → %PRODUCTNAME Writer → 書式サポート
を選択して、
フィールド: 隠し段落
チェックボックスをオフにします。
フィールド内の条件の例
次の例では条件付きテキストフィールドを使用していますが、条件に関連するすべてのフィールドに共通です。条件の構文は、隠しテキスト、隠し段落、任意のレコード、または次のレコードの各フィールドにも適用できます。
ページ数に基づいて条件付きテキストを表示するには、次のようにします。
挿入 → フィールド → その他
を選択して、
機能
タブをクリックします。
フィールドタイプ
から「条件付きテキスト」を選択します。
条件
に「page == 1」と入力します。
条件を満たすとき
に「1 ページしかありません。」と入力します。
条件を満たさないとき
に「複数のページがあります。」と入力します。
挿入
をクリックして、
閉じる
をクリックします。
ユーザー定義の変数に基づいて条件付きテキストを表示するには、次のようにします。
挿入 → フィールド → その他
を選択して、
変数
タブをクリックします。
フィールドタイプ
から「編集の設定」を選択します。
名前
に「利益」と入力します。
値
に「5000」と入力します。
挿入
をクリックします。
機能
タブをクリックして、リスト
フィールドタイプ
から「条件付きテキスト」を選択します。
条件
に「利益 < 5000」と入力します。
条件を満たすとき
に「該当するものはありません。」と入力します。
条件を満たさないとき
に「該当するものがありました。」と入力します。
挿入
をクリックします。
「利益」変数の内容を編集するには、変数フィールドをダブルクリックします。
データベースフィールドの内容に基づいて条件付きテキストを表示するには、次のようにします。
この例の最初の部分ではドキュメントの「名」フィールドと「姓」フィールドの間に空白を挿入し、2 つ目の部分ではフィールドの内容にもとづいてテキストを挿入します。 この例は、$[officename] に住所データソースが登録されていることが前提となります。
挿入 → フィールド → その他
を選択して、
データベース
タブをクリックします。
フィールドタイプ
から「差し込み印刷フィールド」を選択します。
データベースの選択
で「アドレス帳」をダブルクリックして、「名」を選択し、
挿入
をクリックします。「姓」にも同様の手順を行います。
フィールド
に戻ります。
機能
タブをクリックして、リスト
フィールドタイプ
から「条件付きテキスト」を選択します。
条件
に、「アドレス帳.アドレス.名」と入力します。
条件を満たすとき
に 1 文字のスペースを入力します。入力ボックス
条件を満たさないとき
は空のままにします。
これで、「名」フィールドの内容に基づいて条件付きテキストを挿入できるようになりました。
フィールド
で、
機能
タブをクリックします。
フィールドタイプ
から「条件付きテキスト」を選択します。
条件
に、「アドレス帳.アドレス.名 == &quot; Michael &quot; 」と入力します。
条件を満たすとき
に「前略」と入力します。
条件を満たさないとき
ボックスに「こんにちは」と入力します。
挿入
をクリックします。