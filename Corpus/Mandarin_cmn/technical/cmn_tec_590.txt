# language_name_wals:	Mandarin
# language_name_glotto:	Mandarin Chinese
# ISO_6393:	cmn
# year_composed:	NA
# year_published:	NA
# mode:	written
# genre_broad:	technical
# genre_narrow:	NA
# writing_system:	Hans
# special_characters:	NA
# short_description:	OpenOffice
# source:	https://object.pouta.csc.fi/OPUS-OpenOffice/v3/raw/zh_CN.zip
# copyright_short:	http://opus.nlpl.eu/OpenOffice.php
# copyright_long:	http://opus.nlpl.eu/OpenOffice.php J. Tiedemann, 2012, Parallel Data, Tools and Interfaces in OPUS. In Proceedings of the 8th International Conference on Language Resources and Evaluation (LREC 2012)
# sample_type:	whole
# comments:	NA

查询设计
/text/shared/explorer/database/02010100.xhp
视图; 创建数据库视图 (Base)
查询; 在设计视图中创建 (Base)
设计; 查询 (Base)
设计视图; 查询/视图 (Base)
连结; 表格 (Base)
数据库中的表格; 连结查询 (Base)
查询; 连结表格 (Base)
数据库中的表格; 关系 (Base)
关系; 连结表格 (Base)
查询; 删除表格链接 (Base)
查询设计的条件 (Base)
查询; 指定过滤条件 (Base)
过滤条件; 在查询中 (Base)
参数; 查询 (Base)
查询; 参数查询 (Base)
SQL; 查询 (Base)
原生 (native) SQL (Base)
mw added &quot; (Base) &quot; to all entries
查询设计
查询设计视图
允许您创建和编辑数据库查询。
大部分数据库都使用查询来筛选或排序数据库表格，以在您的计算机上显示记录。视图提供与查询相同的功能，但在服务器端提供。如果您的数据库处于支持视图的服务器上，可以使用视图来筛选服务器上的记录以加速显示。
表
创建视图
视图设计
查询设计
窗口相似。
“查询设计”窗口布局可以用已创建的查询存储，不能用已创建的视图存储。
设计视图
查询
在设计视图中创建查询
。
定义
查询的。要定义一个查询，请指定查询包括的数据库
字段名称
以及用于显示这些字段的
条件
。要重新排列“设计视图”下方窗格中的列，请将列标题拖到新的位置，或者选择相应的列并按
Command
Ctrl
+方向键。
查询设计
设计
栏的
图标
。
如果希望测试查询，请在数据库文档中双击该查询名称。查询结果显示在类似于“数据源视图”的表格中。注：显示的表格只是临时的。
查询设计视图中的键
键
功能
F4 键
预览
F5 键
运行查询
F7 键
添加表格或查询
浏览
添加表格
。将显示一个对话框，需要先在其中选择作为查询基础的表格。
双击字段可以将其加入到查询。拖放可以定义关系。
在设计查询期间，无法修改选定的表格。
删除表格
删除
把表格从设计视图中移除。另外，您也可以使用删除键来移除。
移动表格并修改表格大小
可以根据需要来排列表格并改变其大小。要移动一个表格，拖动其上边框到希望放置的位置。要放大或缩小一个表格的显示比例，则拖动其边框或一个角，直到得到想要的大小。
表格关系
如果一个表格中的一个数据字段与另一个表格中的一个数据字段之间存在数据关系，那么您可以把此关系用于您的查询。
例如，有一个商品表格，其中的商品用商品编号标识；还有一个客户表格，用相应的商品编号记录了客户订购的全部商品。这两个表中的“商品编号”数据字段之间就存在关系。如果现在要建立查询，反馈某位客户订购的所有商品，就需要从这两个表格中检索数据。为此，必须在 $[officename] 中指定这两个表格所含数据之间的关系。
为此，单击一个表格中的一个字段名称（例如客户表中的 &quot; Item-Number &quot; 字段），并按住鼠标键把它拖到另一个表格的字段名称上（ &quot; Item &quot; 表格的 &quot; Item-Number &quot; ）。当松开鼠标键，您会看到一根线条已把两个窗口中的这两个字段连接起来了。在由此产生的 SQL 查询中将登记相应的条件，即这两个数据字段的内容必须相同。
只有使用 $[officename] 作为关系数据库的界面，才能建立以多个关联工作表为基础的查询。
不能通过同一个查询访问多个数据库中的表格。只能在一个数据库中建立涉及多个表格的查询。
定义链接类型
插入 - 新建关系
，您可以在
关系
对话框中指定链接的类型。
编辑联接属性
也可以按住 Tab 键直到选中线条，然后按 Shift+F10 组合键来显示上下文菜单并选择指令
编辑
。某些数据库只支持可能联接类型的子集。
删除关系
要删除两个表格间的关系，请用鼠标点击其连线并随后按删除键。
关系
相关字段
包含的相应条目，或者按 Tab 键找到突出显示的连结向量，然后按 Shift+F10 键打开上下文菜单并选择
删除
命令。
定义查询
选择条件以定义查询。
设计表格的每列都接受用于查询的数据字段。一行中的条件用布尔 AND 连接。
指定字段名称
首先，从表格中选择所有要加入到查询的字段名称。这可以通过拖放或者直接双击表格窗口中的字段名称来实现。这里的拖放是指使用鼠标将字段名称从表格窗口拖到 [查询设计] 的下方区域中。拖放时，可以决定将字段加入到哪一列中。如果通过双击来选择字段名称，相应的字段将被加入到下一个空白列。
删除字段名称
删除
。
保存查询
保存
图标来保存查询。将会看到一个要求您输入查询名称的对话框。如果数据库支持略图，您也可以输入略图。
略图
请输入为查询/表格视图指定的架构名称。
查询/表格视图名称
输入查询/表视图的名称。
筛选数据
要筛选查询的数据，请在“视图设计”的下方区域中设置所需的首选项。可以使用以下几行：
字段
输入查询中所引用的数据字段的名称。下面各行中的所有设置都是针对此字段。
通过单击鼠标启动某个单元格，将显示一个箭头按钮，以供选择字段。 &quot; Table name.* &quot; 选项用于选择所有的数据字段，此条件对于所有表格字段均有效。
别名
指定别名。此别名将替代字段名称显示在查询中。这样就可使用用户定义的列标签。
例如，数据字段的名称为 PtNo，而您却希望在查询中显示名称 PartNum，此时就可输入 PartNum 作为别名。
在 SQL 语句中，定义别名的方法如下：
SELECT column AS alias FROM table.
例如：
SELECT &quot; PtNo &quot; AS &quot; PartNum &quot; FROM &quot; Parts &quot;
表格
在此列出所选数据字段对应的数据库表格。
如果通过单击鼠标来启动某个单元格，将显示一个箭头按钮，以供选择当前查询的另一个表格。
排序
如果您单击此单元格，可以选择以下排序选项：升序、降序和不排序。
文本字段按字母顺序排序，数字字段按数字顺序排序。对于大部分数据库，管理员可以设置排序选项。
可见
可见
如果只在编辑条件时使用数据字段，则不必显示该字段。
条件
条件
。
或者
您可以在每一行输入一个附加筛选条件。用“或”链接一列中的多个条件。
此外，还可以通过行标题的上下文菜单在查询设计的下部区域再插入一个函数行。
函数
选择要在此处的查询中运行的函数。
可在此处运行的函数取决于数据库。
函数
行的列表框将有以下选项：
选项
SQL
效果
无函数
无函数可执行。
平均值
AVG
计算一个字段的算术平均值。
记数
Count
确定表格中记录的数目。空字段可以计算在内 (a)，也可以不计算在内 (b)。
a) COUNT(*):如果使用一个小星号作为参数，那么该表的全部记录都将计算在内。
b) COUNT(column)：如果使用一个数据字段作为参数，那么只计算那些含有数值的数据字段。Null 值（空字段）不予计算。
最大值
MAX
确定一个字段的最大值。
最小值
MIN
确定字段的最小值。
总计
SUM
计算各个相关字段的数值总和。
组合
GROUP BY
按照选定的字段名称对查询数据进行组合。根据指定的组合，执行相应的函数。在 SQL 中，此选项对应于 GROUP BY 子句。如果添加某个条件，则对应的条目将显示在 SQL HAVING 中。
也可以直接在 SQL 语句中输入函数，其语法是：
SELECT FUNCTION(column) FROM table.
例如在 SQL 中调用计算总和的函数：
SELECT SUM( &quot; price &quot; ) FROM &quot; article &quot; .
分组
函数，以上函数就是所谓的聚合函数。这些就是用于从结果中计算数据以创建汇总的函数。列表框中没有列出的其他函数也是可能的。这与指定使用何种数据库系统以及 Base 驱动的当前状态有关。
字段
下将其输入。
别名
下输入需要的名称。
SQL 语句中的相应函数是：
SELECT FUNCTION() AS alias FROM table
示例：
SELECT COUNT(*) AS amount FROM &quot; article &quot;
如果您运行了此函数，那么，除了把这些列当作“组合”函数接收外，不能再插入其他的列用于查询。
示例
在以下示例中，通过两个表格来进行查询： &quot; Item &quot; 表格带有字段 &quot; Item_No &quot; ， &quot; Suppliers &quot; 表格带有字段 &quot; Supplier_Name &quot; 。另外，这两个表格还有一个共同的数据字段 &quot; Supplier_No &quot; 。
要建立一个包括所有提供多于 3 种货物的供货商的查询，必须执行下列步骤：
把表 &quot; article &quot; 和 表 &quot; supplier &quot; 插入查询设计。
假如此类型没有关系，那么链接两个表格的 &quot; Supplier_No &quot; 字段。
函数
行，然后选择计算函数。
输入条件 > 3，然后关闭可见的字段。
在表格 &quot; Suppliers &quot; 中双击字段 &quot; Supplier_Name &quot; ，然后选择组合函数。
运行查询。
如果在表格 &quot; Item &quot; 中有字段 &quot; preice &quot; （货物的单价）和字段 &quot; Supplier_No &quot; （货物的供应商），那么您就能用以下查询得到供应商提供的货物的平均价格：
将 &quot; Item &quot; 表格插入查询设计。
双击 &quot; Preice &quot; 和 &quot; Supplier_No &quot; 字段。
函数
行，然后在 &quot; price &quot; 字段中选择平均值函数。
你也可以在用于别名的行中输入“平均值”（不带引号）。
在 &quot; Supplier_No &quot; 字段选择组合。
执行查询。
下面是现有的上下文菜单命令和各式图标：
函数
显示或隐藏用于函数选择的行。
表格名称
显示或隐藏用于表格名称的行。
别名
显示或隐藏别名所在的行。
明确的数值
仅将明确的数值应用于查询。
明确的数值
命令，在查询中仅显示一条记录 (DISTINCT)。否则，将显示所有符合查询条件的数据记录 (ALL)。
明确的数值
命令来指定 &quot; Smith &quot; 在查询中仅出现一次。
明确的数值
命令查询 &quot; last name &quot; 和 &quot; city &quot; 两个字段后，查询结果中将返回一条 &quot; Smith in Chicago &quot; 和一条 &quot; Smith in London &quot; 。
在 SQL 中，此命令对应于 DISTINCT 谓词。
指定筛选条件
在指定筛选条件时，您可以使用各种运算符和命令，包括关系运算符，以及用于查询数据库字段内容的 SQL 特定命令。如果使用 $[officename] 语法来调用这些命令，则 $[officename] 会自动将它们转换成对应的 SQL 语法。也可以直接输入 SQL 命令。下表简要介绍了一些运算符和命令：
运算符
含义
如果...，则条件满足
=
等于
...该字段内容与指定的表达式一致。
=
=
。
< >
不等于
...该字段内容与指定的表达式不一致。
>
大于
...字段内容长于指定的表达式。
<
小于
...字段内容小于指定的表达式。
> =
大于或等于
...该字段内容大于或等于指定表达式。
< =
小于或等于
...该字段内容小于或等于指定的表达式。
$[officename] 命令
SQL 命令
含义
如果...，则条件满足。
为空
IS NULL
为空
... 该数据字段为空。对于带有三种状态的“是/否”字段，该命令自动询问不确定的状态（既非“是”、也非“否”）。
非空
IS NOT NULL
非空
...该数据字段不为空。
LIKE
( 占位符 * 可用于多个字符
占位符 ? 仅表示一个字符 )
LIKE
占位符; 在 SQL 查询中
(% 占位符表示任意数量的字符
占位符 _ 代表一个字符 )
是一个元素，位于
...该数据字段含有指定的表达式。在这里占位符(*)确定表达式 x 是在起始位置(x*)、结束位置(*x)或在字段内容的内部(*x*)出现。您可以在 SQL 查询中输入 SQL 字符 % 作为占位符，在 $[officename] 界面中则输入文件系统常用的占位符是(*)。
占位符符 * 或 % 表示多个任意字符。在 $[officename] 界面中使用问号(?)、在 SQL 查询中使用下划线(_)作为占位符来表示一个字符。
NOT LIKE
NOT LIKE
不是一个元素，位于
...该字段名称不包含指定的表达。
BETWEEN x AND y
BETWEEN x AND y
位于区间 [x,y] 中
...该数据字段含有一个位于 x 和 y 之间的数值。
NICHT ZWISCHEN x UND y
NOT BETWEEN x AND y
不在区间 [x,y] 中
...该字段名称含有一个不在 x 和 y 之间的数值。
IN (a; b; c...)
注意，在全部数值列表中将分号当作分隔符！
IN (a, b, c...)
含有 a, b, c...
... 该数据字段含有指定表达式 a, b, c,... 中的一个。可以指定许多任意的表达，通过“或”链接来获取查询结果。表达 a, b, c... 既可以是数字，也可以是字符。
NICHT IN (a; b; c...)
NOT IN (a, b, c...)
不包含 a, b, c...
...该数据字段不含指定的表达式 a, b, c,...。
= TRUE
= TRUE
值为 True
...该字段名称值为 True。
= FALSCH
= FALSE
有值 false
...该字段名称含有数值 False。
示例
='Ms.'
返回带有字段内容 &quot; Ms. &quot; 的字段。
LIKE 'g?ve'
返回字段内容含有 &quot; give &quot; 和 &quot; gave &quot; 的字段名称。
LIKE 'S*'
返回字段内容为 &quot; Sun &quot; 的数据字段。
BETWEEN 10 AND 20
返回字段内容为 10 到 20 之间的数值的字段名称。（既可以是文本字段也可以是数字字段）。
IN (1; 3; 5; 7)
返回数值 1、3、5、7 的数据字段。如果数据字段包含一个项目编号，则可以创建查询，找出带有指定编号的特定项目。
NOT IN ('M�ler')
返回不包含 &quot; Smith &quot; 的字段名称。
日期字段
用 #Date# 表示以便于识别。在形成的 SQL 语句中通过以下符合 ODBC 的方式重新指定日期条件：
日期
{D'YYYY-MM-DD'}
日期时间
{D'YYYY-MM-DD HH:MM:SS'}
时间
{D'HH:MM:SS'}
Escape 顺序
:
日期
{d 'YYYY-MM-DD'}
时间
{t 'HH:MI:SS[.SS]'} - [ ]optional
日期时间
{ts 'YYYY-MM-DD HH:MI:SS[.SS]'} - [ ]optional
示例：select {d '1999-12-31'} from world.years
Like
Escape Sequence:{escape 'escape-character'}
示例：select * from aticle where artname like 'The *%' {escape '*'}
该示例得到所有项目名称以 'The *' 开头的条目。这意味着你也可以查找其他要被解释为占位符的字符，如 *、?、_、% 或句号。
Outer Join
换码顺序：{oj outer-join}
示例：select Artikel.* from {oj item LEFT OUTER JOIN orders ON item.no=orders.ANR}
查询文字字段
为了查询文本字段的内容，必须将表达式设置在单引号内。是否区分大小写取决于使用的数据库。按照定义，LIKE 区分大小写（尽管一些数据库并不严格区分）。
查询日期字段
即使您想筛选某个日期，也必须将表达式设置在单引号内。可使用下列格式：JJJJ-MM-TT HH:MM:SS 和 JJJJ/MM/TT HH:MM:SS 以及 JJJJ.MM.TT HH:MM:SS
查询是/否字段
要查询“是/否”字段，请在 dBASE 表中使用下列语法：
状态
查询条件
示例
是
对于 dBASE 表格：不等于任何给定的值
=1 返回所有“是/否”字段状态为“是”或“至”的记录（黑色标记）。
否
.
=0 返回所有“是/否”字段状态为“否”或“关闭”的记录（无选择）。
Null
IS NULL
IS NULL 返回所有是/否字段无“是”或“否”这两种状态的记录（灰色标记）。
所用的语法取决于使用的数据库系统。同时还需要注意，“是/否”字段的定义可能会有所不同（仅有 2 种状态，而不是 3 种）。
参数查询
如果需要建立带有变量参数的查询，则必须在变量前后加上方括号 (=[x])，或者在等号后加上冒号 (=:x)。在执行查询时，程序会显示一个对话框，询问您要将变量 x 指定给哪个表达式。
如果同时查询多个参数，对话框中将显示含有所有参数的列表字段，并且每个参数旁显示有一个输入行。最好按照从上至下的顺序输入数值，每输完一行后按 Enter 键。
参数查询中不能使用占位符 (*、_) 或特殊字符（例如 ?）。
如果编辑一个参数查询并与变量一起保存，则以后再建立类似的查询时，只需要用所需的表达式替换原来的变量即可。打开查询时，$[officename] 会要求您在对话框中输入这些变量。
输入参数值
参数输入
确定
确认。
子表单
，因为对于子表单的查询，需要调用的数值是从变量内部读取的。
SQL 指令中的参数查询可有以下格式：
select * from 'addresses' where 'name' = :placeholder
SQL 模式
SQL 意为 &quot; Structured Query Language &quot; （结构化查询语言），描述用于查询、更新和管理关系数据库的指令。
打开/关闭设计视图
按钮切换至 SQL 视图，则可看到已建立查询的 SQL 命令。
您可以直接用 SQL 代码表达查询。但要注意，特殊语法由您使用的数据库系统决定。
查询设计
中的图形界面不支持该查询。必须在本地 SQL 模式中执行此类查询。
直接运行 SQL 指令
图标，可以建立不由 $[officename] 处理的查询。